{"abi":[{"inputs":[{"internalType":"contract GPv2Authentication","name":"authenticator_","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"contract ERC20","name":"sellToken","type":"address"},{"indexed":false,"internalType":"contract ERC20","name":"buyToken","type":"address"},{"indexed":false,"internalType":"uint256","name":"sellAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"buyAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"feeAmount","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"orderUid","type":"bytes"}],"name":"Trade","type":"event"},{"inputs":[],"name":"allowanceManager","outputs":[{"internalType":"contract GPv2AllowanceManager","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"domainSeparator","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"","type":"bytes"}],"name":"filledAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"orderUid","type":"bytes"}],"name":"invalidateOrder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract ERC20[]","name":"tokens","type":"address[]"},{"internalType":"uint256[]","name":"clearingPrices","type":"uint256[]"},{"internalType":"bytes","name":"encodedTrades","type":"bytes"},{"internalType":"bytes","name":"encodedInteractions","type":"bytes"},{"internalType":"bytes","name":"encodedOrderRefunds","type":"bytes"}],"name":"settle","outputs":[],"stateMutability":"nonpayable","type":"function"}],"bytecode":"0x60e06040523480156200001157600080fd5b50604051620025703803806200257083398101604081905262000034916200012f565b6001600160601b0319606082901b1660a0526040514690620000c3907f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f907f6c85c0337eba1661327f94f3bf46c8a7f9311a563f4d5c948362567f5d8ed60c907ff9446b8e937d86f0bc87cac73923491692b123ca5f8761908494703758206adf90859030906020016200015f565b60408051601f19818403018152908290528051602090910120608052620000ea9062000121565b604051809103906000f08015801562000107573d6000803e3d6000fd5b5060601b6001600160601b03191660c052506200018b9050565b61068a8062001ee683390190565b60006020828403121562000141578081fd5b81516001600160a01b038116811462000158578182fd5b9392505050565b9485526020850193909352604084019190915260608301526001600160a01b0316608082015260a00190565b60805160a05160601c60c05160601c611d19620001cd600039806102ef52806103b05280610f945250806101e45250806103d452806105005250611d196000f3fe608060405234801561001057600080fd5b50600436106100675760003560e01c80637caf7af0116100505780637caf7af0146100aa578063c4b1e4fb146100bd578063f698da25146100d257610067565b806315337bc01461006c5780632479fb6e14610081575b600080fd5b61007f61007a36600461182a565b6100da565b005b61009461008f36600461186a565b61018a565b6040516100a191906119f3565b60405180910390f35b61007f6100b836600461171f565b6101a7565b6100c56103ae565b6040516100a19190611949565b6100946103d2565b60006100e683836103f6565b5091505073ffffffffffffffffffffffffffffffffffffffff81163314610142576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611a8a565b60405180910390fd5b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6000848460405161017592919061191d565b90815260405190819003602001902055505050565b805160208183018101805160008252928201919093012091525481565b6040517f02cc250d00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff7f000000000000000000000000000000000000000000000000000000000000000016906302cc250d90610219903390600401611949565b60206040518083038186803b15801561023157600080fd5b505afa158015610245573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610269919061180a565b61029f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611bd4565b60606102af8b8b8b8b8b8b610484565b6040517feaeecbb600000000000000000000000000000000000000000000000000000000815290915073ffffffffffffffffffffffffffffffffffffffff7f0000000000000000000000000000000000000000000000000000000000000000169063eaeecbb69061032490849060040161196a565b600060405180830381600087803b15801561033e57600080fd5b505af1158015610352573d6000803e3d6000fd5b5050505061036085856105a0565b610369816105d5565b81156103a1576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611ac1565b5050505050505050505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b7f000000000000000000000000000000000000000000000000000000000000000081565b600080806038841461046957604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601160248201527f475076323a20696e76616c696420756964000000000000000000000000000000604482015290519081900360640190fd5b5050823593602084013560601c936034013560e01c92509050565b606060006104928484610609565b90508067ffffffffffffffff811180156104ab57600080fd5b506040519080825280602002602001820160405280156104e557816020015b6104d26115bf565b8152602001906001900390816104ca5790505b5091506104f06115ed565b60005b828110156105935761053a7f00000000000000000000000000000000000000000000000000000000000000008b8b8561052d8b8b88610685565b9094909390929091610693565b61058b828989856020015160ff1681811061055157fe5b905060200201358a8a866040015160ff1681811061056b57fe5b9050602002013587858151811061057e57fe5b6020026020010151610ac2565b6001016104f3565b5050509695505050505050565b6105a8611632565b82825b80156105ce576105bc828285610eb1565b915091506105c983610f92565b6105ab565b5050505050565b60005b8151811015610605576105fd8282815181106105f057fe5b60200260200101516110a6565b6001016105d8565b5050565b600060ce82061561067b57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601a60248201527f475076323a206d616c666f726d65642074726164652064617461000000000000604482015290519081900360640190fd5b5060ce9004919050565b60ce90810292909201929050565b8051600287013560408201526022870135606080830191909152604688013560e090811c60a0840152604a89013560c090930192909252606b88013590830152608b87013560f01c6080830152863560f890811c916001890135821c9160428a013590911c90606a8a0135811c90608d8b0135901c608e8b013560ae8c013589898881811061071e57fe5b8a5173ffffffffffffffffffffffffffffffffffffffff602090920293909301351690915250898960ff881681811061075357fe5b8a516020918202939093013573ffffffffffffffffffffffffffffffffffffffff1692019190915250875163ffffffff8616608090910152600184166107c15787517ff3b277728b3fee749481eb3e0b3b48980dbbab78658fc419025cb16eee34677560e0909101526107eb565b87517f6ed88e868af0a1983e3886d5f3e95a2fafbd6c3450bc229e27342283dc429ccc60e0909101525b87516002851615156101009091015260ff80881660208a015286166040808a019190915288517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe00180517fb2b38b9dcbdeb41f7ad71dea9aed79fb47f7bbc3436576fe994b43d5b16ecdec82526101408220915290516000608086166108c9578d8360405160200180807f190100000000000000000000000000000000000000000000000000000000000081525060020183815260200182815260200192505050604051602081830303815290604052805190602001209050610923565b8d8360405160200180807f19457468657265756d205369676e6564204d6573736167653a0a363400000000815250601c01838152602001828152602001925050506040516020818303038152906040528051906020012090505b6040805160008082526020808301808552859052601f8a168385015260608301899052608083018890529251909260019260a0808201937fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe081019281900390910190855afa158015610999573d6000803e3d6000fd5b50506040517fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0015191505073ffffffffffffffffffffffffffffffffffffffff8116610a4657604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601760248201527f475076323a20696e76616c6964207369676e6174757265000000000000000000604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff811660a08d0152604083905260c08c015151603814610a9757604080516038808252606082019092529060208201818036833750505060c08d01525b602060c08d015101896018820152816014820152848152505050505050505050505050505050505050565b610aca61164a565b846000015190507ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffee06040510160405242816080015163ffffffff161015610b3d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611af8565b60a085015173ffffffffffffffffffffffffffffffffffffffff9081168352815181166020808501919091528201511660408301526060810151610b8190846110d7565b6040820151610b9090866110d7565b1015610bc8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611b2f565b6000806000807ff3b277728b3fee749481eb3e0b3b48980dbbab78658fc419025cb16eee3467758560e001511415610cce5784610100015115610c3757886060015193508460400151610c28858760c001516110d790919063ffffffff16565b81610c2f57fe5b049150610c46565b846040015193508460c0015191505b86610c51858a6110d7565b81610c5857fe5b049250610c898460008b60c00151604051610c73919061192d565b9081526040519081900360200190205490611153565b90508460400151811115610cc9576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611b9d565b610d87565b84610100015115610d0b57886060015192508460600151610cfc848760c001516110d790919063ffffffff16565b81610d0357fe5b049150610d1a565b846060015192508460c0015191505b87610d2584896110d7565b81610d2c57fe5b049350610d478360008b60c00151604051610c73919061192d565b90508460600151811115610d87576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611b9d565b612710896080015161ffff161115610dcb576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611b66565b612710610ded8a6080015161ffff1661271003846110d790919063ffffffff16565b81610df457fe5b049150610e018483611153565b60608701526080860183905260c08901516040518291600091610e24919061192d565b908152602001604051809103902081905550856000015173ffffffffffffffffffffffffffffffffffffffff167fa07a543ab8a018198e99ca0184c93fe9050a79400a0a723441f84de1d972cc178760200151886040015189606001518a60800151878f60c00151604051610e9e969594939291906119fc565b60405180910390a2505050505050505050565b823560601c8152366000601485013560e81c6017810180861015610f3657604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601960248201527f475076323a20696e76616c696420696e746572616374696f6e00000000000000604482015290519081900360640190fd5b604080516020601f85018190048102820181019092528381528289019550828803945060178901918491908390839081908401838280828437600092019190915250505050602090970196909652509296919550909350505050565b7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16816000015173ffffffffffffffffffffffffffffffffffffffff16141561101c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161013990611c0b565b60006060826000015173ffffffffffffffffffffffffffffffffffffffff16836020015160405161104d919061192d565b6000604051808303816000865af19150503d806000811461108a576040519150601f19603f3d011682016040523d82523d6000602084013e61108f565b606091505b5091509150816110a157805160208201fd5b505050565b8051608082015160408301516110d49273ffffffffffffffffffffffffffffffffffffffff909116916111c7565b50565b6000826110e65750600061114d565b828202828482816110f357fe5b041461114a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526021815260200180611c996021913960400191505060405180910390fd5b90505b92915050565b60008282018381101561114a57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f536166654d6174683a206164646974696f6e206f766572666c6f770000000000604482015290519081900360640190fd5b6040805173ffffffffffffffffffffffffffffffffffffffff8416602482015260448082018490528251808303909101815260649091019091526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fa9059cbb000000000000000000000000000000000000000000000000000000001790526110a190849060606112b1826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c65648152508573ffffffffffffffffffffffffffffffffffffffff166113279092919063ffffffff16565b8051909150156110a1578080602001905160208110156112d057600080fd5b50516110a1576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a815260200180611cba602a913960400191505060405180910390fd5b60606113368484600085611340565b90505b9392505050565b60608247101561139b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526026815260200180611c736026913960400191505060405180910390fd5b6113a4856114fb565b61140f57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b600060608673ffffffffffffffffffffffffffffffffffffffff1685876040518082805190602001908083835b6020831061147957805182527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0909201916020918201910161143c565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d80600081146114db576040519150601f19603f3d011682016040523d82523d6000602084013e6114e0565b606091505b50915091506114f0828286611501565b979650505050505050565b3b151590565b60608315611510575081611339565b8251156115205782518084602001fd5b816040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825283818151815260200191508051906020019080838360005b8381101561158457818101518382015260200161156c565b50505050905090810190601f1680156115b15780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b6040805160a08101825260008082526020820181905291810182905260608101829052608081019190915290565b6040518060e0016040528061160061164a565b81526000602082018190526040820181905260608083018290526080830182905260a083019190915260c09091015290565b60408051808201909152600081526060602082015290565b6040805161012081018252600080825260208201819052918101829052606081018290526080810182905260a0810182905260c0810182905260e0810182905261010081019190915290565b60008083601f8401126116a7578182fd5b50813567ffffffffffffffff8111156116be578182fd5b60208301915083602080830285010111156116d857600080fd5b9250929050565b60008083601f8401126116f0578182fd5b50813567ffffffffffffffff811115611707578182fd5b6020830191508360208285010111156116d857600080fd5b60008060008060008060008060008060a08b8d03121561173d578586fd5b8a3567ffffffffffffffff80821115611754578788fd5b6117608e838f01611696565b909c509a5060208d0135915080821115611778578788fd5b6117848e838f01611696565b909a50985060408d013591508082111561179c578788fd5b6117a88e838f016116df565b909850965060608d01359150808211156117c0578586fd5b6117cc8e838f016116df565b909650945060808d01359150808211156117e4578384fd5b506117f18d828e016116df565b915080935050809150509295989b9194979a5092959850565b60006020828403121561181b578081fd5b8151801515811461114a578182fd5b6000806020838503121561183c578182fd5b823567ffffffffffffffff811115611852578283fd5b61185e858286016116df565b90969095509350505050565b6000602080838503121561187c578182fd5b823567ffffffffffffffff80821115611893578384fd5b818501915085601f8301126118a6578384fd5b8135818111156118b257fe5b604051847fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0601f84011682010181811084821117156118ed57fe5b6040528181528382018501881015611903578586fd5b818585018683013790810190930193909352509392505050565b6000828483379101908152919050565b6000825161193f818460208701611c42565b9190910192915050565b73ffffffffffffffffffffffffffffffffffffffff91909116815260200190565b602080825282518282018190526000919060409081850190868401855b828110156119e6578151805173ffffffffffffffffffffffffffffffffffffffff908116865287820151811688870152868201511686860152606080820151908601526080908101519085015260a09093019290850190600101611987565b5091979650505050505050565b90815260200190565b600073ffffffffffffffffffffffffffffffffffffffff808916835280881660208401525085604083015284606083015283608083015260c060a083015282518060c0840152611a538160e0850160208701611c42565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169190910160e001979650505050505050565b6020808252601f908201527f475076323a2063616c6c657220646f6573206e6f74206f776e206f7264657200604082015260600190565b60208082526013908201527f6e6f742079657420696d706c656d656e74656400000000000000000000000000604082015260600190565b60208082526013908201527f475076323a206f72646572206578706972656400000000000000000000000000604082015260600190565b6020808252601f908201527f475076323a206c696d6974207072696365206e6f742072657370656374656400604082015260600190565b6020808252601a908201527f475076323a20696e76616c69642066656520646973636f756e74000000000000604082015260600190565b60208082526012908201527f475076323a206f726465722066696c6c65640000000000000000000000000000604082015260600190565b60208082526012908201527f475076323a206e6f74206120736f6c7665720000000000000000000000000000604082015260600190565b6020808252601b908201527f475076323a20666f7262696464656e20696e746572616374696f6e0000000000604082015260600190565b60005b83811015611c5d578181015183820152602001611c45565b83811115611c6c576000848401525b5050505056fe416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6c536166654d6174683a206d756c7469706c69636174696f6e206f766572666c6f775361666545524332303a204552433230206f7065726174696f6e20646964206e6f742073756363656564a2646970667358221220fde34971272f32f7dafa19895cfa5579509580db2bcdf45b9c1ea375ce2617fc64736f6c6343000705003360a060405234801561001057600080fd5b5033606081901b60805261065a61003060003980605d525061065a6000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063eaeecbb614610030575b600080fd5b61004361003e36600461052d565b610045565b005b3373ffffffffffffffffffffffffffffffffffffffff7f000000000000000000000000000000000000000000000000000000000000000016146100bd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100b49061059d565b60405180910390fd5b60005b818110156100eb576100e38383838181106100d757fe5b905060a00201336100f0565b6001016100c0565b505050565b61011e73ffffffffffffffffffffffffffffffffffffffff6020840135811690843516836060860135610122565b5050565b6040805173ffffffffffffffffffffffffffffffffffffffff80861660248301528416604482015260648082018490528251808303909101815260849091019091526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f23b872dd000000000000000000000000000000000000000000000000000000001790526101b79085906101bd565b50505050565b606061021f826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c65648152508573ffffffffffffffffffffffffffffffffffffffff166102959092919063ffffffff16565b8051909150156100eb5780806020019051602081101561023e57600080fd5b50516100eb576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a8152602001806105fb602a913960400191505060405180910390fd5b60606102a484846000856102ae565b90505b9392505050565b606082471015610309576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806105d56026913960400191505060405180910390fd5b61031285610469565b61037d57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b600060608673ffffffffffffffffffffffffffffffffffffffff1685876040518082805190602001908083835b602083106103e757805182527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe090920191602091820191016103aa565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d8060008114610449576040519150601f19603f3d011682016040523d82523d6000602084013e61044e565b606091505b509150915061045e82828661046f565b979650505050505050565b3b151590565b6060831561047e5750816102a7565b82511561048e5782518084602001fd5b816040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825283818151815260200191508051906020019080838360005b838110156104f25781810151838201526020016104da565b50505050905090810190601f16801561051f5780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b6000806020838503121561053f578182fd5b823567ffffffffffffffff80821115610556578384fd5b818501915085601f830112610569578384fd5b813581811115610577578485fd5b86602060a08302850101111561058b578485fd5b60209290920196919550909350505050565b6020808252601d908201527f475076323a206e6f7420616c6c6f77616e636520726563697069656e7400000060408201526060019056fe416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6c5361666545524332303a204552433230206f7065726174696f6e20646964206e6f742073756363656564a264697066735822122099ab47db9afef36997e395eb6e941905a21ab9c3f996266655532f872060a06164736f6c63430007050033","devdoc":{"author":"Gnosis Developers","events":{"Trade(address,address,address,uint256,uint256,uint256,bytes)":{"details":"Event emitted for each executed trade."}},"kind":"dev","methods":{"invalidateOrder(bytes)":{"details":"Invalidate onchain an order that has been signed offline.","params":{"orderUid":"The unique identifier of the order that is to be made invalid after calling this function. The user that created the order must be the the sender of this message. See [`extractOrderUidParams`] for details on orderUid."}},"settle(address[],uint256[],bytes,bytes,bytes)":{"details":"Settle the specified orders at a clearing price. Note that it is the responsibility of the caller to ensure that all GPv2 invariants are upheld for the input settlement, otherwise this call will revert. Namely: - The fee factor cannot lead to fees > 0.1% - All orders are valid and signed - Accounts have sufficient balance and approval. - Settlement contract has sufficient balance to execute trades. Note   this implies that the accumulated fees held in the contract can also   be used for settlement. This is OK since:   - Solvers need to be authorized   - Misbehaving solvers will be slashed for abusing accumulated fees for     settlement   - Critically, user orders are entirely protected Note that some parameters are encoded as packed bytes in order to save calldata gas. For more information on encoding format consult the [`GPv2Encoding`] library.","params":{"clearingPrices":"An array of clearing prices where the `i`-th price is for the `i`-th token in the [`tokens`] array.","encodedInteractions":"Encoded smart contract interactions.","encodedOrderRefunds":"Encoded order refunds for clearing storage related to invalid orders.","encodedTrades":"Encoded trades for signed EOA orders.","tokens":"An array of ERC20 tokens to be traded in the settlement. Orders and interactions encode tokens as indices into this array."}}},"stateVariables":{"BPS_BASE":{"details":"The number of basis points to make up 100%."},"DOMAIN_NAME":{"details":"The EIP-712 domain name used for computing the domain separator."},"DOMAIN_TYPE_HASH":{"details":"The EIP-712 domain type hash used for computing the domain separator."},"DOMAIN_VERSION":{"details":"The EIP-712 domain version used for computing the domain separator."},"allowanceManager":{"details":"The allowance manager which has access to EOA order funds. This contract is created during deployment"},"authenticator":{"details":"The authenticator is used to determine who can call the settle function. That is, only authorised solvers have the ability to invoke settlements. Any valid authenticator implements an isSolver method called by the onlySolver modifier below."},"domainSeparator":{"details":"The domain separator used for signing orders that gets mixed in making signatures for different domains incompatible. This domain separator is computed following the EIP-712 standard and has replay protection mixed in so that signed orders are only valid for specific GPv2 contracts."},"filledAmount":{"details":"Map each user order by UID to the amount that has been filled so far. If this amount is larger than or equal to the amount traded in the order (amount sold for sell orders, amount bought for buy orders) then the order cannot be traded anymore. If the order is fill or kill, then this value is only used to determine whether the order has already been executed."}},"title":"Gnosis Protocol v2 Settlement Contract","version":1},"userdoc":{"kind":"user","methods":{},"version":1}}